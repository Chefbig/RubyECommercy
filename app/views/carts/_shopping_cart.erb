<h1>Shopping Cart</h1><hr>
<% if session[:cart].nil? || session[:cart].empty?%>
    <div class="col-md-8 col-md-offset-2 empty_cart">
      WoW! You cart is still empty :(
    </div>
<%else%>

<table class="table table-striped table-hover table-bordered">
  <tbody>
    <tr>
      <th>Item</th>
      <th>QTY</th>
      <th>Unit Price</th>
      <th>Total Price</th>
    </tr>
      <% @sub_total = 0 %>
      <% session[:cart].each_key do |key| %>
          <% @item = Product.find(key) %>
          <% @line_total = @item.price * session[:cart][key] %>
          <% @sub_total += @line_total %>
          <tr>
            <td><%=link_to @item.name, @item %></td>
            <td>
              <div class="input-group number-spinner">
                <input type="number" class="form-control text-center" value=<%= session[:cart][key] %> min="0" max="40">

                <span class="input-group-btn data-up">
					        <button class="btn btn-default btn-info" data-dir="up"><span class="glyphicon glyphicon-remove-sign"></span></button>
				        </span>
              </div>
            </td>

            <td><%= @item.price %></td>
            <td><%= @line_total %></td>
          </tr>
      <% end %>

    <tr>
      <th colspan="2"><span class="pull-right">Sub Total</span></th>
      <th><a href="#" class="btn btn-primary">Update Cart</a></th>
      <th><%= @sub_total %></th>
    </tr>

    <tr>
      <td colspan="2"></td>
      <td colspan="2"> <%= link_to "Checkout", new_order_path, class: "glyphicon glyphicon-shopping-cart pull-right btn btn-success" %>
    </tr>
  </tbody>
</table>
<% end %>