<h1>Shopping Cart</h1><hr>
<% if session[:cart].nil? || session[:cart].empty?%>
    <div class="col-md-8 col-md-offset-2 empty_cart">
      WoW! You cart is still empty :(
    </div>
<%else%>

<table class="table table-striped table-hover table-bordered">
  <tbody>
    <tr>
      <th>Item</th>
      <th>QTY</th>
      <th>Unit Price</th>
      <th>Total Price</th>
    </tr>
      <% @sub_total = 0 %>
      <% session[:cart].each_key do |key| %>
          <% @item = Product.find(key) %>
          <% @line_total = @item.price * session[:cart][key] %>
          <% @sub_total += @line_total %>
          <tr>
            <td><%=link_to @item.name, @item %></td>
            <td><%= session[:cart][key] %> <a href="#">X</a></td>
            <td><%= @item.price %></td>
            <td><%= @line_total %></td>
          </tr>
      <% end %>

    <tr>
      <th colspan="3"><span class="pull-right">Sub Total</span></th>
      <th><%= @sub_total %></th>
    </tr>

    <tr>
      <td colspan="2"><a href="#" class="btn btn-primary">Update Cart</a></td>
      <td colspan="2"><a href="#" class="pull-right btn btn-success">Checkout</a></td>
    </tr>
  </tbody>
</table>
<% end %>